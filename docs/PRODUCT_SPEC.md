# PRODUCT SPEC（题目 1-4 说明）

## 1. 用户类型与用户故事
**目标用户**：
- 二次元/文学/历史爱好者：希望与喜欢的角色互动（娱乐/陪伴）。
- 学生与自学者：希望通过拟人化对话学习（历史、哲学、文化、口语）。
- 轻社交用户：希望新奇有趣的语音互动，提升临场感。

**痛点**：
- 文字AI缺少临场感与情绪；语音助手“无人格”。
- 学习枯燥、缺乏趣味性；缺少“角色老师”式的陪伴指导。
- 需要中英文双语练习；希望一站式语音对话。

**用户故事（举例）**：
- 我是哈利波特迷，想听魔法世界轶事并练习英语口语。
- 我在学哲学，想让“苏格拉底”用提问法引导我思考。
- 我对中医感兴趣，想听“李时珍”讲草药与调理方向（不涉及处方）。
- 我做项目想请教“诸葛亮”，希望得到“形势-对策-后效”的三段式建议。

## 2. 功能与优先级
| 功能 | 描述 | 优先级 | 本次范围 |
|---|---|---|---|
| 角色搜索/选择 | 搜索关键词匹配；选择后进入对话 | 高 | ✅ |
| 语音识别（ASR） | 浏览器录音 → Whisper 识别中/英文 | 高 | ✅ |
| LLM角色对话 | 基于角色 Prompt + 上下文生成人格化回复 | 高 | ✅ |
| 语音合成（TTS） | gTTS 输出中/英文音色 | 高 | ✅ |
| 多轮上下文 | 保留最近8条消息维护上下文 | 中 | ✅ |
| 文字输入 | 不便语音时使用文本对话 | 中 | ✅ |
| 角色资料卡 | 简介/背景/示例问法 | 低 | ⬜ |
| 用户自定义角色 | 用户上传Persona与技能 | 低 | ⬜ |

**本次开发**：交付高优先级功能 + 基础上下文记忆与文本输入。

## 3. LLM 模型选择
**候选对比**（概述）：GPT-4/4o、Claude、Gemini、中文大模型等。综合考虑**角色拟人度**、**双语能力**、**API稳定性**与**成本**，本项目默认采用 **OpenAI GPT-4o-mini**（可改环境变量切换）。理由：
- 拟人对话质量高，风格可塑性好；对中英双语支持成熟。
- API 接入简单，生态完善；Whisper 与 TTS 可顺畅联用。
- 通过历史消息 + 系统 Prompt 能较好遵从角色技能。

如需更长上下文或不同风格，可封装在 `services/llm.py` 里切换。

## 4. AI 角色技能（除语音聊天外）
**技能仅用 Prompt 实现（不依赖 Agent）：**
- **哈利·波特**：霍格沃茨故事讲述 / 魔法咒语教学 / 魔法谜语挑战
- **苏格拉底**：哲学问答 / 产婆术提问 / 历史背景讲解
- **李时珍**：本草建议 / 望闻问切 / 医理故事
- **诸葛亮**：兵法谋略 / 三段式推演（形势-对策-后效）/ 典故引用

> 角色 Prompt 详见 `backend/data/characters.yaml`。

